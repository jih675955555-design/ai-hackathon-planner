<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Company-wide AI Planning Hackathon - AX Proposal Tool</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --primary: #1a56db;
            --primary-dark: #1e40af;
            --primary-light: #3b82f6;
            --secondary: #0f172a;
            --accent: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-main: #f8fafc;
            --bg-card: #ffffff;
            --bg-input: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --border: #e2e8f0;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
            --radius: 12px;
            --radius-sm: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-main);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 20px 40px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-lg);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--accent) 0%, var(--primary-light) 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }

        .logo-text h1 {
            font-size: 18px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .logo-text span {
            font-size: 12px;
            opacity: 0.8;
            font-weight: 400;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-ghost {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .btn-ghost:hover {
            background: rgba(255,255,255,0.2);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        /* Progress Bar */
        .progress-container {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            padding: 24px 40px;
        }

        .progress-wrapper {
            max-width: 1200px;
            margin: 0 auto;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 40px;
            right: 40px;
            height: 3px;
            background: var(--border);
            z-index: 1;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 40px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            z-index: 2;
            transition: width 0.5s ease;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 3;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-number {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background: var(--bg-card);
            border: 3px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
            color: var(--text-muted);
            transition: all 0.3s ease;
        }

        .step.active .step-number {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
            box-shadow: 0 0 0 4px rgba(26, 86, 219, 0.2);
        }

        .step.completed .step-number {
            border-color: var(--success);
            background: var(--success);
            color: white;
        }

        .step.completed .step-number::after {
            content: '‚úì';
        }

        .step.completed .step-number span {
            display: none;
        }

        .step-label {
            margin-top: 10px;
            font-size: 13px;
            color: var(--text-muted);
            font-weight: 500;
            text-align: center;
            max-width: 100px;
        }

        .step.active .step-label {
            color: var(--primary);
            font-weight: 600;
        }

        .step.completed .step-label {
            color: var(--success);
        }

        /* Main Content */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px 40px;
        }

        .form-section {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .form-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            margin-bottom: 28px;
        }

        .section-title {
            font-size: 26px;
            font-weight: 700;
            color: var(--secondary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title .emoji {
            font-size: 28px;
        }

        .section-desc {
            color: var(--text-secondary);
            font-size: 15px;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 28px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border);
        }

        .card-title {
            font-size: 17px;
            font-weight: 600;
            color: var(--secondary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .card-title .badge {
            font-size: 11px;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 500;
        }

        .badge-required {
            background: #fef2f2;
            color: var(--danger);
        }

        .badge-optional {
            background: #f0fdf4;
            color: var(--success);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .form-label .required {
            color: var(--danger);
            margin-left: 2px;
        }

        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 15px;
            font-family: inherit;
            transition: all 0.2s ease;
            background: var(--bg-input);
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(26, 86, 219, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-help {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 6px;
        }

        /* Hint Button */
        .hint-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: #fef3c7;
            color: #92400e;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: 10px;
        }

        .hint-btn:hover {
            background: #fde68a;
        }

        .hint-content {
            display: none;
            background: #fffbeb;
            border: 1px solid #fde68a;
            border-radius: var(--radius-sm);
            padding: 16px;
            margin-top: 12px;
            font-size: 14px;
            color: #92400e;
            line-height: 1.7;
        }

        .hint-content.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .hint-content strong {
            display: block;
            margin-bottom: 8px;
            color: #78350f;
        }

        .hint-content ul {
            margin-left: 20px;
        }

        .hint-content li {
            margin-bottom: 4px;
        }

        /* Validation Status */
        .validation-box {
            background: var(--bg-input);
            border-radius: var(--radius);
            padding: 20px;
            margin-top: 24px;
        }

        .validation-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--secondary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .validation-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            border-radius: var(--radius-sm);
            margin-bottom: 10px;
            background: white;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .validation-item.pass {
            border-color: var(--success);
            background: #f0fdf4;
        }

        .validation-item.fail {
            border-color: var(--warning);
            background: #fffbeb;
        }

        .validation-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            flex-shrink: 0;
            background: var(--border);
            color: var(--text-muted);
        }

        .validation-item.pass .validation-icon {
            background: var(--success);
            color: white;
        }

        .validation-item.fail .validation-icon {
            background: var(--warning);
            color: white;
        }

        .validation-text {
            flex: 1;
        }

        .validation-text strong {
            display: block;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .validation-text span {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Grid Layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        /* ROI Calculator */
        .roi-calculator {
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            border-radius: var(--radius);
            padding: 28px;
            color: white;
            margin-top: 20px;
        }

        .roi-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .roi-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        .roi-item {
            background: rgba(255,255,255,0.1);
            border-radius: var(--radius-sm);
            padding: 16px;
            text-align: center;
        }

        .roi-item label {
            display: block;
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 8px;
        }

        .roi-item .value {
            font-size: 28px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        .roi-item .unit {
            font-size: 14px;
            opacity: 0.8;
        }

        /* Flow Diagram */
        .flow-container {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            padding: 20px;
            background: var(--bg-input);
            border-radius: var(--radius);
            margin-bottom: 16px;
        }

        .flow-item {
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 12px 16px;
            font-size: 13px;
            display: flex;
            flex-direction: column;
            gap: 4px;
            min-width: 120px;
        }

        .flow-item .system {
            font-size: 11px;
            color: var(--primary);
            font-weight: 600;
        }

        .flow-arrow {
            color: var(--text-muted);
            font-size: 20px;
        }

        .flow-ai {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            border: none;
        }

        .flow-ai .system {
            color: rgba(255,255,255,0.8);
        }

        /* Task Table */
        .task-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        .task-table th,
        .task-table td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        .task-table th {
            background: var(--bg-input);
            font-weight: 600;
            color: var(--secondary);
        }

        .task-table tbody tr:hover {
            background: var(--bg-input);
        }

        .task-table input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }

        .task-table input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .add-task-btn {
            margin-top: 12px;
            padding: 10px 20px;
            background: var(--bg-input);
            border: 2px dashed var(--border);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
        }

        .add-task-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: white;
        }

        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
        }

        .nav-buttons .btn {
            padding: 14px 32px;
            font-size: 15px;
        }

        /* Preview Section */
        .preview-container {
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 40px;
            margin-top: 20px;
        }

        .preview-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 24px;
            border-bottom: 2px solid var(--secondary);
        }

        .preview-header h1 {
            font-size: 24px;
            color: var(--secondary);
            margin-bottom: 8px;
        }

        .preview-header h2 {
            font-size: 18px;
            color: var(--primary);
            font-weight: 500;
        }

        .preview-section {
            margin-bottom: 28px;
        }

        .preview-section h3 {
            font-size: 16px;
            color: var(--secondary);
            padding: 10px 16px;
            background: var(--bg-input);
            border-left: 4px solid var(--primary);
            margin-bottom: 16px;
        }

        .preview-content {
            padding: 0 16px;
            font-size: 15px;
            line-height: 1.8;
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 12px;
        }

        .preview-table th,
        .preview-table td {
            padding: 12px 16px;
            border: 1px solid var(--border);
            font-size: 14px;
        }

        .preview-table th {
            background: var(--bg-input);
            font-weight: 600;
            width: 150px;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: var(--radius);
            padding: 32px;
            max-width: 500px;
            width: 90%;
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal h3 {
            font-size: 20px;
            margin-bottom: 16px;
            color: var(--secondary);
        }

        .modal p {
            color: var(--text-secondary);
            margin-bottom: 24px;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--secondary);
            color: white;
            padding: 16px 24px;
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1001;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            background: var(--success);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
            .roi-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 16px 20px;
            }
            .main-container {
                padding: 20px;
            }
            .progress-container {
                padding: 16px 20px;
            }
            .step-label {
                display: none;
            }
            .roi-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Data Tech Tags */
        .tech-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .tech-tag {
            padding: 8px 14px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tech-tag:hover {
            border-color: var(--primary);
        }

        .tech-tag.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Export buttons */
        .export-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            flex-wrap: wrap;
        }

        /* Effect Items */
        .effect-item {
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            margin-bottom: 16px;
            overflow: hidden;
        }

        .effect-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 20px;
            background: var(--bg-input);
            border-bottom: 1px solid var(--border);
        }

        .effect-icon {
            font-size: 20px;
        }

        .effect-type {
            font-weight: 600;
            color: var(--secondary);
            flex: 1;
        }

        .effect-content {
            padding: 20px;
        }

        .effect-content.hidden {
            display: none;
        }

        /* Toggle Switch */
        .effect-toggle {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 26px;
        }

        .effect-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border);
            transition: 0.3s;
            border-radius: 26px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .effect-toggle input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        .effect-toggle input:checked + .toggle-slider:before {
            transform: translateX(22px);
        }

        .export-btn {
            flex: 1;
            min-width: 200px;
            padding: 16px 24px;
            border-radius: var(--radius-sm);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .export-pdf {
            background: #dc2626;
            color: white;
        }

        .export-pdf:hover {
            background: #b91c1c;
        }

        .export-word {
            background: #2b579a;
            color: white;
        }

        .export-word:hover {
            background: #1e3f6f;
        }

        .export-print {
            background: var(--secondary);
            color: white;
        }

        .export-print:hover {
            background: #1e293b;
        }

        /* Print Styles */
        @media print {
            .header, .progress-container, .nav-buttons, .export-buttons, .validation-box, .card-title .hint-btn {
                display: none !important;
            }
            .main-container {
                padding: 0;
                max-width: 100%;
            }
            .form-section {
                display: none !important;
            }
            #step6 {
                display: block !important;
            }
            .card {
                box-shadow: none;
                border: 1px solid #ddd;
                break-inside: avoid;
            }
            .preview-container {
                border: none;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üöÄ</div>
                <div class="logo-text">
                    <h1>Company-wide AI Planning Hackathon</h1>
                    <span>AX Planning Hackathon Proposal Tool</span>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn btn-ghost" onclick="loadData()">
                    <span>üìÇ</span> Load
                </button>
                <button class="btn btn-ghost" onclick="saveData()">
                    <span>üíæ</span> Save
                </button>
                <button class="btn btn-primary" onclick="goToStep(6)">
                    <span>üìÑ</span> Preview
                </button>
            </div>
        </div>
    </header>

    <div class="progress-container">
        <div class="progress-wrapper">
            <div class="progress-steps">
                <div class="progress-line" id="progressLine"></div>
                <div class="step active" onclick="goToStep(1)">
                    <div class="step-number"><span>1</span></div>
                    <div class="step-label">Basic Info & Pain Point</div>
                </div>
                <div class="step" onclick="goToStep(2)">
                    <div class="step-number"><span>2</span></div>
                    <div class="step-label">As-Is Analysis</div>
                </div>
                <div class="step" onclick="goToStep(3)">
                    <div class="step-number"><span>3</span></div>
                    <div class="step-label">To-Be Scenario</div>
                </div>
                <div class="step" onclick="goToStep(4)">
                    <div class="step-number"><span>4</span></div>
                    <div class="step-label">Data & Technology</div>
                </div>
                <div class="step" onclick="goToStep(5)">
                    <div class="step-number"><span>5</span></div>
                    <div class="step-label">ROI Calculation</div>
                </div>
                <div class="step" onclick="goToStep(6)">
                    <div class="step-number"><span>6</span></div>
                    <div class="step-label">Final Review</div>
                </div>
            </div>
        </div>
    </div>

    <main class="main-container">
        <section class="form-section active" id="step1">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="emoji">üí°</span>
                    Basic Information & Pain Point Discovery
                </h2>
                <p class="section-desc">Specifically define the business problems you want to solve with AI adoption. Please clearly describe the actual difficulties faced in the field.</p>
            </div>

            <div class="card">
                <div class="card-title">
                    Project Basic Information
                    <span class="badge badge-required">Required</span>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">Proposal Name <span class="required">*</span></label>
                        <input type="text" class="form-input" id="projectName" placeholder="e.g., AI Assistant for Training Completion Status Management">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Core Objective <span class="required">*</span></label>
                        <input type="text" class="form-input" id="coreProject" placeholder="e.g., Achieve 100% training completion rate and automate management tasks">
                    </div>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">Department</label>
                        <input type="text" class="form-input" id="department" placeholder="e.g., HRD Team">
                    </div>
                    <div class="form-group">
                        <label class="form-label">AI Champion Name</label>
                        <input type="text" class="form-input" id="champion" placeholder="e.g., John Smith">
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">
                    Project Definition
                    <button class="hint-btn" onclick="toggleHint('hint1')">üí° View Example</button>
                </div>
                <div class="hint-content" id="hint1">
                    <strong>‚úÖ Good Example (Pass Criteria)</strong>
                    <p>"To solve the issues of omissions and delays caused by manual management of mandatory legal training and job training completion status, AI will automatically link education platform and HR system data to identify non-completers in real-time and automatically send reminder emails, thereby achieving 100% training completion rate and improving management efficiency."</p>
                    <br>
                    <strong>‚ùå Examples to Avoid (Review Required)</strong>
                    <ul>
                        <li>"It would be nice if AI could figure it out" ‚Üí Missing the "How"</li>
                        <li>"Work is hard" ‚Üí Pain point is not specific</li>
                    </ul>
                </div>
                <div class="form-group">
                    <label class="form-label">Project Definition <span class="required">*</span></label>
                    <textarea class="form-textarea" id="projectDefinition" placeholder="Clearly define what this project does in one sentence."></textarea>
                    <p class="form-help">Tip: Write in the format "Through ~, achieve ~"</p>
                </div>
            </div>

            <div class="card">
                <div class="card-title">
                    Problem to Solve (Pain Point)
                    <button class="hint-btn" onclick="toggleHint('hint2')">üí° Writing Guide</button>
                </div>
                <div class="hint-content" id="hint2">
                    <strong>‚úÖ Pain Point Specification Checklist</strong>
                    <ul>
                        <li>How much time does this task currently take?</li>
                        <li>How dependent is it on the experience and knowledge of the person in charge?</li>
                        <li>What is the likelihood of mistakes or errors?</li>
                        <li>Where is the data scattered?</li>
                        <li>What are the repetitive tasks?</li>
                    </ul>
                </div>
                <div class="form-group">
                    <label class="form-label">Current Work Difficulties and Inefficiencies <span class="required">*</span></label>
                    <textarea class="form-textarea" id="painPoint" placeholder="e.g., It takes an average of over 2 hours to compile monthly training completion status, and 45 minutes just to identify non-completers of mandatory training. Repetitive work occurs from sending individual reminder emails."></textarea>
                </div>
            </div>

            <div class="card">
                <div class="card-title">Expected Benefits of Implementation</div>
                <div class="form-group">
                    <label class="form-label">Expected Effects of AI Adoption <span class="required">*</span></label>
                    <textarea class="form-textarea" id="expectedEffect" placeholder="e.g., AI automatically links training data and HR data to identify non-completers in real-time. Automation of reminder email sending reduces management work time and eliminates penalty risk."></textarea>
                </div>
            </div>

            <div class="validation-box">
                <div class="validation-title">üìã Self-Assessment Checklist</div>
                <div class="validation-item" id="v1-painpoint">
                    <div class="validation-icon">?</div>
                    <div class="validation-text">
                        <strong>Pain Point Specificity</strong>
                        <span>Are the difficulties and inefficiencies (Pain Points) in the field specifically described?</span>
                    </div>
                </div>
                <div class="validation-item" id="v1-how">
                    <div class="validation-icon">?</div>
                    <div class="validation-text">
                        <strong>Clarity of Solution</strong>
                        <span>Is there specific operational logic, not just "AI will figure it out"?</span>
                    </div>
                </div>
                <div class="validation-item" id="v1-connection">
                    <div class="validation-icon">?</div>
                    <div class="validation-text">
                        <strong>Connection Point</strong>
                        <span>Has it been decided where in the business process AI will be utilized?</span>
                    </div>
                </div>
            </div>

            <div class="nav-buttons">
                <div></div>
                <button class="btn btn-primary" onclick="nextStep()">Next Step ‚Üí</button>
            </div>
        </section>

        <section class="form-section" id="step2">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="emoji">üìä</span>
                    As-Is Current State Analysis
                </h2>
                <p class="section-desc">Analyze the current business process in detail before AI adoption. Please specify the time required and systems used at each stage.</p>
            </div>

            <div class="card">
                <div class="card-title">
                    Current Business Process (As-Is)
                    <button class="hint-btn" onclick="toggleHint('hint3')">üí° View Example</button>
                </div>
                <div class="hint-content" id="hint3">
                    <strong>‚úÖ As-Is Scenario Example</strong>
                    <div class="flow-container" style="margin-top: 12px;">
                        <div class="flow-item">
                            <span class="system">Training Platform</span>
                            <span>[HR Team] Download completion list for each training</span>
                        </div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="flow-item">
                            <span class="system">Excel</span>
                            <span>Manually organize completion status by dept/position</span>
                        </div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="flow-item">
                            <span class="system">Email</span>
                            <span>[HR Team] Send individual reminder emails to non-completers</span>
                        </div>
                    </div>
                    <p style="margin-top: 12px; font-size: 13px;">‚Äª Please include the time required and system used for each step.</p>
                </div>
                <div class="form-group">
                    <label class="form-label">Current Workflow Description <span class="required">*</span></label>
                    <textarea class="form-textarea" id="asisDescription" style="min-height: 150px;" placeholder="Please describe step by step how the current work is being done.

Example:
1. [HR Team] Compile completion lists for each training (Time: 30 min)
2. [HR Team] Organize completion status by dept/position in Excel (Time: 1 hour)
3. [HR Team] Manually check non-completers of mandatory training (Time: 45 min)
4. [HR Team] Send individual reminder emails to non-completers (Time: 30 min)"></textarea>
                </div>
            </div>

            <div class="card">
                <div class="card-title">Problems with Current Process</div>
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">Time Inefficiency</label>
                        <textarea class="form-textarea" id="asisTimeProblem" placeholder="e.g., It takes an average of over 2 hours to compile monthly training status, and 45 minutes just to check non-completers. Repetitive work occurs from individual reminder emails."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Quality/Accuracy Issues</label>
                        <textarea class="form-textarea" id="asisQualityProblem" placeholder="e.g., Omissions and errors occur during manual compilation. Discrepancies between departments reduce accuracy in identifying non-completers. Difficult to identify people approaching training deadlines."></textarea>
                    </div>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">System/Data Issues</label>
                        <textarea class="form-textarea" id="asisSystemProblem" placeholder="e.g., Poor integration between training platform and HR system. Different data formats for each training. Manual updates for terminated/transferred employees reduce data consistency."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Other Issues</label>
                        <textarea class="form-textarea" id="asisOtherProblem" placeholder="e.g., Delays in status tracking when person in charge is absent. Compliance risk from missing mandatory training. Unable to analyze capabilities based on training history."></textarea>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">Current Systems and Tools Used</div>
                <div class="form-group">
                    <label class="form-label">Related Systems List</label>
                    <div class="tech-tags" id="systemTags">
                        <span class="tech-tag" onclick="toggleTag(this)">SAP</span>
                        <span class="tech-tag" onclick="toggleTag(this)">PLM</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Word</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Veeva</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Excel</span>
                        <span class="tech-tag" onclick="toggleTag(this)">SharePoint</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Email</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Manual Work</span>
                    </div>
                    <input type="text" class="form-input" id="customSystems" style="margin-top: 12px;" placeholder="Enter other systems if any (comma separated)">
                </div>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-outline" onclick="prevStep()">‚Üê Previous Step</button>
                <button class="btn btn-primary" onclick="nextStep()">Next Step ‚Üí</button>
            </div>
        </section>

        <section class="form-section" id="step3">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="emoji">üéØ</span>
                    To-Be Scenario Design
                </h2>
                <p class="section-desc">Design the business process that will change after AI adoption. Please clearly distinguish between areas handled by AI and areas handled by people.</p>
            </div>

            <div class="card">
                <div class="card-title">
                    Business Process After AI Adoption (To-Be)
                    <button class="hint-btn" onclick="toggleHint('hint4')">üí° Design Guide</button>
                </div>
                <div class="hint-content" id="hint4">
                    <strong>‚úÖ Pass Criteria: Process Redesign</strong>
                    <ul>
                        <li>Clear step-by-step changes from As-Is (current) to To-Be (future) process</li>
                        <li>Clear separation of areas where AI handles independently and where humans handle</li>
                        <li>Human-in-the-loop: Design how humans will verify and supplement AI results</li>
                    </ul>
                    <br>
                    <strong>‚ùå Review Required</strong>
                    <ul>
                        <li>Feature listing: Vague expectation that AI will solve all problems at once without context</li>
                        <li>No verification: No consideration of steps to confirm reliability of AI results</li>
                    </ul>
                </div>
                <div class="form-group">
                    <label class="form-label">Workflow After AI Adoption <span class="required">*</span></label>
                    <textarea class="form-textarea" id="tobeDescription" style="min-height: 150px;" placeholder="Please describe step by step the workflow that will change after AI adoption.

Example:
1. [HR Team] Enter training status inquiry request into system (Time: 5 min)
2. [AI] Automatically link training platform/HR system data to analyze completion status by dept/position and auto-generate non-completer list (Automatic)
3. [HR Team] Review AI-generated status report and batch send reminder emails to mandatory training non-completers (Time: 10 min)
4. [HR Team] Verify AI analysis results and enter feedback (Time: 5 min)"></textarea>
                </div>
            </div>

            <div class="card">
                <div class="card-title">AI Role Definition</div>
                <div class="form-group">
                    <label class="form-label">Tasks AI Will Perform <span class="required">*</span></label>
                    <textarea class="form-textarea" id="aiRole" placeholder="e.g.:
- Automatic linking and compilation of training platform and HR system data
- Automatic analysis of training completion status by dept/position
- Automatic extraction of mandatory training non-completers and list generation
- Advance alerts for people approaching training deadlines
- Auto-generation of reminder email templates for non-completers"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Tasks Humans Will Perform <span class="required">*</span></label>
                    <textarea class="form-textarea" id="humanRole" placeholder="e.g.:
- Review appropriateness of AI-generated status reports
- Confirm reasons for non-completion and exception handling decisions
- Final approval for sending reminder emails
- Update AI criteria when training policies change
- Provide feedback on AI analysis results"></textarea>
                </div>
            </div>

            <div class="card">
                <div class="card-title">AI Interaction Design</div>
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">Input</label>
                        <textarea class="form-textarea" id="aiInput" placeholder="e.g.: Query date, target dept/position, training type (mandatory/job-related/optional), query period"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Output</label>
                        <textarea class="form-textarea" id="aiOutput" placeholder="e.g.: Completion rate dashboard by dept, non-completer list (name/dept/incomplete training/deadline), deadline alert list, reminder email draft"></textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Exception Handling Plan</label>
                    <textarea class="form-textarea" id="exceptionHandling" placeholder="e.g.: Auto-exclude terminated/on-leave employees, reflect current dept for transferred employees, send review request alert to person in charge when data discrepancy occurs, request criteria mapping confirmation when new training is registered"></textarea>
                    <p class="form-help">Include error prevention phrases such as making AI respond "I don't know" when it cannot find information.</p>
                </div>
            </div>

            <div class="validation-box">
                <div class="validation-title">üìã Self-Assessment Checklist</div>
                <div class="validation-item" id="v3-process">
                    <div class="validation-icon">?</div>
                    <div class="validation-text">
                        <strong>Process Redesign</strong>
                        <span>Are the As-Is ‚Üí To-Be process changes clearly diagrammed step by step?</span>
                    </div>
                </div>
                <div class="validation-item" id="v3-humanloop">
                    <div class="validation-icon">?</div>
                    <div class="validation-text">
                        <strong>Human-in-the-loop</strong>
                        <span>Is there a 'Human-in-the-loop' system for how humans will verify and supplement AI results?</span>
                    </div>
                </div>
                <div class="validation-item" id="v3-exception">
                    <div class="validation-icon">?</div>
                    <div class="validation-text">
                        <strong>Exception Handling</strong>
                        <span>Are there error prevention phrases such as making AI respond "I don't know" when it cannot find information?</span>
                    </div>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-outline" onclick="prevStep()">‚Üê Previous Step</button>
                <button class="btn btn-primary" onclick="nextStep()">Next Step ‚Üí</button>
            </div>
        </section>

        <section class="form-section" id="step4">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="emoji">üóÑÔ∏è</span>
                    Data & Technology Review
                </h2>
                <p class="section-desc">Review the data and technical elements required for AI implementation. Data availability is key to project success.</p>
            </div>

            <div class="card">
                <div class="card-title">
                    Required Data
                    <button class="hint-btn" onclick="toggleHint('hint5')">üí° Data Checklist</button>
                </div>
                <div class="hint-content" id="hint5">
                    <strong>‚úÖ Pass Criteria: Data Strategy</strong>
                    <ul>
                        <li>Sample data analysis: Understand the structure of actual data to be used</li>
                        <li>Preprocessing plan: Establish plan to remove data noise (unnecessary information)</li>
                        <li>Data freshness: Define if data needs periodic updates and update cycle</li>
                        <li>Security/Compliance: Review personal data anonymization and internal security regulations</li>
                    </ul>
                    <br>
                    <strong>‚ùå Review Required</strong>
                    <ul>
                        <li>No data: Ideas exist but documents or data to support them are not digitized</li>
                        <li>Vague expectations: Reference targets too broad like "information on the internet"</li>
                    </ul>
                </div>
                <div class="form-group">
                    <label class="form-label">Required Data List <span class="required">*</span></label>
                    <textarea class="form-textarea" id="requiredData" placeholder="e.g.:
- Training platform completion data (training name, completion date, completer info)
- HR system data (employee ID, name, dept, position, hire date, employment status)
- Mandatory training list and completion cycle info
- Mapping info of required training by dept/position"></textarea>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">Data Source/Location</label>
                        <textarea class="form-textarea" id="dataSource" placeholder="e.g.:
- Internal training platform (LMS) DB
- HR System DB
- Mandatory training management ledger (Excel/SharePoint)"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Data Type/Format</label>
                        <textarea class="form-textarea" id="dataFormat" placeholder="e.g.:
- Structured data: DB tables (SQL)
- Semi-structured: Excel, CSV
- Training completion records: API integration"></textarea>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">Data Quality and Preprocessing</div>
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">Expected Data Quality Issues</label>
                        <textarea class="form-textarea" id="dataQualityIssue" placeholder="e.g.:
- Inconsistent data formats across training platforms
- Delayed reflection of terminated/on-leave status
- Inconsistent dept code mapping
- Inconsistent training name notation (abbreviation/full name)"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Preprocessing/Cleansing Plan</label>
                        <textarea class="form-textarea" id="dataPreprocessing" placeholder="e.g.:
- Build training name standardization dictionary
- Organize dept code mapping table
- Real-time employment status reflection through HR system integration
- Apply duplicate completion record removal logic"></textarea>
                    </div>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">Data Update Cycle</label>
                        <select class="form-select" id="dataUpdateCycle">
                            <option value="">Please select</option>
                            <option value="realtime">Real-time</option>
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="quarterly">Quarterly</option>
                            <option value="onetime">One-time (No update needed)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Security/Compliance Considerations</label>
                        <textarea class="form-textarea" id="dataSecurity" placeholder="e.g.:
- Personal info included: Name, employee ID
- Access rights: Limited to HR team and dept managers
- Data storage: Internal server, no external export
- Personal info consent: Completed at time of hire"></textarea>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">Related AI Technologies</div>
                <div class="form-group">
                    <label class="form-label">AI Technologies to Apply</label>
                    <div class="tech-tags" id="techTags">
                        <span class="tech-tag" onclick="toggleTag(this)">LLM (Large Language Model)</span>
                        <span class="tech-tag" onclick="toggleTag(this)">RAG (Retrieval Augmented Generation)</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Text Summarization</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Text Classification</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Image Recognition</span>
                        <span class="tech-tag" onclick="toggleTag(this)">OCR</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Recommendation System</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Predictive Analytics</span>
                        <span class="tech-tag" onclick="toggleTag(this)">NLP</span>
                        <span class="tech-tag" onclick="toggleTag(this)">Speech Recognition</span>
                    </div>
                </div>
                <div class="form-group" style="margin-top: 16px;">
                    <label class="form-label">Technology Application Plan Description</label>
                    <textarea class="form-textarea" id="techDescription" placeholder="e.g.: LLM-based natural language query for training status, report generation through automatic data linking and analysis, advance alert function through non-completer pattern analysis"></textarea>
                </div>
            </div>

            <div class="validation-box">
                <div class="validation-title">üìã Self-Assessment Checklist</div>
                <div class="validation-item" id="v4-datasample">
                    <div class="validation-icon">?</div>
                    <div class="validation-text">
                        <strong>Sample Data Analysis</strong>
                        <span>Have you understood the structure of the actual data samples to be used?</span>
                    </div>
                </div>
                <div class="validation-item" id="v4-preprocessing">
                    <div class="validation-icon">?</div>
                    <div class="validation-text">
                        <strong>Preprocessing Plan</strong>
                        <span>Is there a plan for data noise removal and processing?</span>
                    </div>
                </div>
                <div class="validation-item" id="v4-security">
                    <div class="validation-icon">?</div>
                    <div class="validation-text">
                        <strong>Security/Compliance</strong>
                        <span>Have you reviewed personal data anonymization and internal security regulations compliance?</span>
                    </div>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-outline" onclick="prevStep()">‚Üê Previous Step</button>
                <button class="btn btn-primary" onclick="nextStep()">Next Step ‚Üí</button>
            </div>
        </section>

        <section class="form-section" id="step5">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="emoji">üìà</span>
                    Expected Benefits & ROI Calculation
                </h2>
                <p class="section-desc">Write specific quantitative/qualitative effects from AI adoption. Please provide numbers and calculation basis together.</p>
            </div>

            <div class="card" style="background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%); color: white; border: none;">
                <div class="card-title" style="color: white; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 16px; margin-bottom: 20px;">
                    üéØ Key Expected Benefit (One-line Summary)
                </div>
                <div class="form-group">
                    <input type="text" class="form-input" id="keyBenefit" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; font-size: 16px; padding: 16px;" placeholder="e.g.: 85% reduction in training status management time (2hr 45min ‚Üí 20min per month) and zero mandatory training non-compliance risk">
                </div>
                <div class="grid-2" style="margin-top: 16px;">
                    <div class="form-group">
                        <label class="form-label" style="color: rgba(255,255,255,0.8); font-size: 13px;">Expected Duration</label>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <input type="number" class="form-input" id="projectDuration" style="width: 100px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; text-align: center;" placeholder="10">
                            <span style="color: rgba(255,255,255,0.8);">months</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">
                    üìä Quantitative Benefits
                    <button class="hint-btn" onclick="toggleHint('hint6')">üí° Writing Guide</button>
                </div>
                <div class="hint-content" id="hint6">
                    <strong>‚úÖ Pass Criteria</strong>
                    <p>Beyond simple convenience, effects must be estimated with specific numbers.</p>
                    <br>
                    <strong>üìù Examples by Benefit Type</strong>
                    <ul>
                        <li><strong>Time Savings:</strong> 10,000 hours saved annually (20 people √ó 1 case/week √ó 1 hour √ó 52 weeks √ó 80%)</li>
                        <li><strong>Cost Reduction:</strong> $50,000 annual outsourcing cost savings ($5,000/month √ó 10 cases)</li>
                        <li><strong>Revenue Increase:</strong> Expected 5% increase in repurchase rate from faster customer response</li>
                        <li><strong>Quality Improvement:</strong> Defect rate reduced from 2% to 0.5% ($3M annual defect cost savings)</li>
                    </ul>
                </div>

                <div class="effect-item">
                    <div class="effect-header">
                        <span class="effect-icon">‚è±Ô∏è</span>
                        <span class="effect-type">Time Savings</span>
                        <label class="effect-toggle">
                            <input type="checkbox" id="effect_time_enabled" checked onchange="toggleEffectSection('time')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="effect-content" id="effect_time_content">
                        <div class="form-group">
                            <label class="form-label">Benefit Description</label>
                            <textarea class="form-textarea" id="effect_time_value" style="min-height: 80px;" placeholder="e.g.: 85% reduction in training status management time (approx. 2hr 25min saved monthly)"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Calculation Basis</label>
                            <textarea class="form-textarea" id="effect_time_basis" style="min-height: 80px;" placeholder="e.g.: Current: 2hr 45min per month (compile 30min + organize 1hr + check 45min + send 30min)
After AI: 20min per month (query 5min + review 10min + feedback 5min)
Time saved: 2hr 25min/month √ó 12 months = 29 hours saved annually"></textarea>
                        </div>
                    </div>
                </div>

                <div class="effect-item">
                    <div class="effect-header">
                        <span class="effect-icon">üí∞</span>
                        <span class="effect-type">Cost Reduction</span>
                        <label class="effect-toggle">
                            <input type="checkbox" id="effect_cost_enabled" onchange="toggleEffectSection('cost')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="effect-content hidden" id="effect_cost_content">
                        <div class="form-group">
                            <label class="form-label">Benefit Description</label>
                            <textarea class="form-textarea" id="effect_cost_value" style="min-height: 80px;" placeholder="e.g.: Eliminate penalty risk from mandatory training non-compliance (up to $50,000 per incident)"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Calculation Basis</label>
                            <textarea class="form-textarea" id="effect_cost_basis" style="min-height: 80px;" placeholder="e.g.: Possible penalties for mandatory training non-compliance (safety training, etc.)
Average annual incidents: 5 √ó penalty per incident $10,000-50,000 = up to $250,000 risk cost
AI adoption prevents non-compliance in advance ‚Üí Risk eliminated"></textarea>
                        </div>
                    </div>
                </div>

                <div class="effect-item">
                    <div class="effect-header">
                        <span class="effect-icon">üìà</span>
                        <span class="effect-type">Revenue/Profit Increase</span>
                        <label class="effect-toggle">
                            <input type="checkbox" id="effect_revenue_enabled" onchange="toggleEffectSection('revenue')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="effect-content hidden" id="effect_revenue_content">
                        <div class="form-group">
                            <label class="form-label">Benefit Description</label>
                            <textarea class="form-textarea" id="effect_revenue_value" style="min-height: 80px;" placeholder="e.g.: 10% increase in CS satisfaction from faster customer response, 5% increase in repurchase rate expected"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Calculation Basis</label>
                            <textarea class="form-textarea" id="effect_revenue_basis" style="min-height: 80px;" placeholder="e.g.: Current average response time 30min ‚Üí reduced to 5min
Based on CS satisfaction survey analysis of correlation between response speed and repurchase rate"></textarea>
                        </div>
                    </div>
                </div>

                <div class="effect-item">
                    <div class="effect-header">
                        <span class="effect-icon">‚úÖ</span>
                        <span class="effect-type">Quality/Accuracy Improvement</span>
                        <label class="effect-toggle">
                            <input type="checkbox" id="effect_quality_enabled" onchange="toggleEffectSection('quality')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="effect-content hidden" id="effect_quality_content">
                        <div class="form-group">
                            <label class="form-label">Benefit Description</label>
                            <textarea class="form-textarea" id="effect_quality_value" style="min-height: 80px;" placeholder="e.g.: Achieve 99%+ accuracy in training status tracking, 0% non-completer omission rate"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Calculation Basis</label>
                            <textarea class="form-textarea" id="effect_quality_basis" style="min-height: 80px;" placeholder="e.g.: Current manual compilation omission/error rate approx. 5%
AI auto-linking ensures data consistency ‚Üí Error rate below 1%
Auto-extraction of non-completers achieves zero omissions"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">
                    ‚ú® Qualitative Benefits
                    <button class="hint-btn" onclick="toggleHint('hint7')">üí° View Examples</button>
                </div>
                <div class="hint-content" id="hint7">
                    <strong>Qualitative Benefit Examples</strong>
                    <ul>
                        <li>Reduced quality variation across personnel</li>
                        <li>Shortened new hire onboarding period (6 months ‚Üí 2 months)</li>
                        <li>Converting tacit knowledge to explicit knowledge as organizational assets</li>
                        <li>Improved employee job satisfaction from reduced repetitive work</li>
                        <li>Establishing data-driven decision-making culture</li>
                        <li>Increased cross-departmental collaboration efficiency</li>
                    </ul>
                </div>
                <div class="form-group">
                    <label class="form-label">Expected Qualitative Benefits</label>
                    <textarea class="form-textarea" id="qualitativeValue" style="min-height: 120px;" placeholder="e.g.:
- Reduced workload for person in charge - Focus on training planning/improvement instead of simple repetitive compilation work
- Proactive compliance risk prevention - Prevent non-completion with deadline alerts
- Data-driven training operations - Establish basis for training policy through completion status analysis
- Business continuity even when person in charge is absent - AI auto-generates status"></textarea>
                </div>
            </div>

            <div class="card">
                <div class="card-title">üöÄ Scalability</div>
                <div class="form-group">
                    <label class="form-label">Potential for Expansion to Other Departments/Company-wide</label>
                    <textarea class="form-textarea" id="scalability" placeholder="e.g.:
- Phase 1: HR team mandatory training management application (2 months)
- Phase 2: Company-wide job training/leadership training expansion (4 months)
- Phase 3: Overseas subsidiary training status integrated management (8 months)

Similar applicable tasks:
- Certification/license renewal management
- Safety training completion management (production/R&D depts)
- New hire onboarding training management"></textarea>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-outline" onclick="prevStep()">‚Üê Previous Step</button>
                <button class="btn btn-primary" onclick="nextStep()">Next Step ‚Üí</button>
            </div>
        </section>

        <section class="form-section" id="step6">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="emoji">‚úÖ</span>
                    Final Review & Proposal Generation
                </h2>
                <p class="section-desc">Final review of the content and generate the proposal.</p>
            </div>

            <div class="card">
                <div class="card-title">Required Tasks for Execution</div>
                <table class="task-table">
                    <thead>
                        <tr>
                            <th style="width: 5%;">No.</th>
                            <th style="width: 55%;">Required Tasks for Execution</th>
                            <th style="width: 20%;">Prerequisites</th>
                            <th style="width: 20%;">Duration</th>
                        </tr>
                    </thead>
                    <tbody id="taskTableBody">
                        <tr>
                            <td>1</td>
                            <td><input type="text" id="task1_desc" placeholder="e.g.: [System] API integration development between training platform and HR system"></td>
                            <td><input type="text" id="task1_prereq" placeholder="None"></td>
                            <td><input type="text" id="task1_duration" placeholder="1M"></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><input type="text" id="task2_desc" placeholder="e.g.: [Data] Training name standardization and dept code mapping table setup"></td>
                            <td><input type="text" id="task2_prereq" placeholder="None"></td>
                            <td><input type="text" id="task2_duration" placeholder="2W"></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td><input type="text" id="task3_desc" placeholder="e.g.: [AI Feature] Training completion auto-analysis and report generation development"></td>
                            <td><input type="text" id="task3_prereq" placeholder="1,2"></td>
                            <td><input type="text" id="task3_duration" placeholder="1M"></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td><input type="text" id="task4_desc" placeholder="e.g.: [AI Feature] Non-completer auto-extraction and reminder email auto-generation development"></td>
                            <td><input type="text" id="task4_prereq" placeholder="3"></td>
                            <td><input type="text" id="task4_duration" placeholder="2W"></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td><input type="text" id="task5_desc" placeholder="e.g.: [Test] Pilot operation and feedback incorporation"></td>
                            <td><input type="text" id="task5_prereq" placeholder="4"></td>
                            <td><input type="text" id="task5_duration" placeholder="1M"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="card">
                <div class="card-title">üìã Final Evaluation Criteria Check</div>
                <div class="validation-box" style="margin-top: 0; background: white;">
                    <h4 style="margin-bottom: 16px; color: var(--secondary);">‚ë† Problem Definition and Solution Logic</h4>
                    <div class="validation-item" id="vf-tobe">
                        <div class="validation-icon">?</div>
                        <div class="validation-text">
                            <strong>To-Be Diagram</strong>
                            <span>Clear step-by-step As-Is (current) and To-Be (future) process changes after AI adoption</span>
                        </div>
                    </div>
                    <div class="validation-item" id="vf-roi">
                        <div class="validation-icon">?</div>
                        <div class="validation-text">
                            <strong>ROI Calculation</strong>
                            <span>Time savings (Hours) or cost reduction effects estimated with quantitative numbers</span>
                        </div>
                    </div>
                    <div class="validation-item" id="vf-scalability">
                        <div class="validation-icon">?</div>
                        <div class="validation-text">
                            <strong>Scalability</strong>
                            <span>Is this plan a model that can be expanded to other departments or company-wide?</span>
                        </div>
                    </div>
                    <div class="validation-item" id="vf-aicollab">
                        <div class="validation-icon">?</div>
                        <div class="validation-text">
                            <strong>AI Collaboration</strong>
                            <span>Clear separation of areas where AI handles independently and where humans handle</span>
                        </div>
                    </div>

                    <h4 style="margin: 24px 0 16px; color: var(--secondary);">‚ë° Data Strategy</h4>
                    <div class="validation-item" id="vf-datasample">
                        <div class="validation-icon">?</div>
                        <div class="validation-text">
                            <strong>Sample Data Analysis</strong>
                            <span>Understanding the structure of actual data samples to be used</span>
                        </div>
                    </div>
                    <div class="validation-item" id="vf-dataprocess">
                        <div class="validation-icon">?</div>
                        <div class="validation-text">
                            <strong>Preprocessing Plan</strong>
                            <span>Plan for data noise removal and processing established</span>
                        </div>
                    </div>
                    <div class="validation-item" id="vf-compliance">
                        <div class="validation-icon">?</div>
                        <div class="validation-text">
                            <strong>Security/Compliance</strong>
                            <span>Reviewed personal data anonymization and internal security regulations compliance</span>
                        </div>
                    </div>

                    <h4 style="margin: 24px 0 16px; color: var(--secondary);">‚ë¢ AI Working Logic and Scenario</h4>
                    <div class="validation-item" id="vf-interaction">
                        <div class="validation-icon">?</div>
                        <div class="validation-text">
                            <strong>Interaction Logic</strong>
                            <span>Is the Q&A sequence and feedback loop between user and AI elaborately designed?</span>
                        </div>
                    </div>
                    <div class="validation-item" id="vf-validation">
                        <div class="validation-icon">?</div>
                        <div class="validation-text">
                            <strong>Verification Process</strong>
                            <span>Is there a Human-in-the-loop system for how humans will verify and supplement AI results?</span>
                        </div>
                    </div>
                    <div class="validation-item" id="vf-exception">
                        <div class="validation-icon">?</div>
                        <div class="validation-text">
                            <strong>Exception Handling</strong>
                            <span>Are there error prevention phrases such as making AI respond "I don't know" when it cannot find information?</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">üìÑ Proposal Preview</div>
                <div class="preview-container" id="previewContainer">
                    </div>
            </div>

            <div class="export-buttons">
                <button class="export-btn export-pdf" onclick="exportToPDF()">
                    <span>üìï</span> Save as PDF
                </button>
                <button class="export-btn export-word" onclick="exportToWord()">
                    <span>üìù</span> Save as Word
                </button>
                <button class="export-btn export-print" onclick="window.print()">
                    <span>üñ®Ô∏è</span> Print
                </button>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-outline" onclick="prevStep()">‚Üê Previous Step</button>
                <button class="btn btn-success" onclick="submitPlan()">üéâ Submit Proposal</button>
            </div>
        </section>
    </main>

    <div class="toast" id="toast">
        <span id="toastIcon">‚úì</span>
        <span id="toastMessage">Saved successfully.</span>
    </div>

    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <h3 id="modalTitle">Load Saved Data</h3>
            <p id="modalMessage">Previously saved proposal data exists. Would you like to load it?</p>
            <div class="modal-buttons">
                <button class="btn btn-outline" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" onclick="confirmLoad()">Load</button>
            </div>
        </div>
    </div>

    <script>
        // State Management
        let currentStep = 1;
        const totalSteps = 6;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            checkSavedData();
            updateProgress();
            setupAutoSave();
            setupValidation();
        });

        // --- [Utility] Security: HTML Escape function for XSS prevention ---
        function escapeHtml(text) {
            if (!text) return '';
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // --- [Utility] Text Formatting: Line break handling ---
        function formatText(text) {
            if (!text) return '-';
            // First neutralize (escape) HTML tags, then convert line break characters to <br>
            return escapeHtml(text).replace(/\n/g, '<br>');
        }

        // Step Navigation
        function goToStep(step) {
            if (step < 1 || step > totalSteps) return;
            
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(`step${step}`).classList.add('active');
            
            currentStep = step;
            updateProgress();
            
            if (step === 6) {
                generatePreview();
                runFinalValidation();
            }
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function nextStep() {
            if (currentStep < totalSteps) {
                goToStep(currentStep + 1);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                goToStep(currentStep - 1);
            }
        }

        // Progress Bar Update
        function updateProgress() {
            const steps = document.querySelectorAll('.step');
            const progressLine = document.getElementById('progressLine');
            
            steps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 === currentStep) {
                    step.classList.add('active');
                } else if (index + 1 < currentStep) {
                    step.classList.add('completed');
                }
            });
            
            const progress = ((currentStep - 1) / (totalSteps - 1)) * 100;
            // Add safety measure when calculating parent container width
            const container = document.querySelector('.progress-steps');
            const maxWidth = container ? container.offsetWidth - 80 : 0; 
            progressLine.style.width = `${(progress / 100) * maxWidth}px`;
        }

        // Hint Toggle
        function toggleHint(hintId) {
            const hint = document.getElementById(hintId);
            if(hint) hint.classList.toggle('show');
        }

        // Tag Toggle
        function toggleTag(element) {
            element.classList.toggle('selected');
        }

        // Get Selected Tags
        function getSelectedTags(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return [];
            const selected = container.querySelectorAll('.tech-tag.selected');
            return Array.from(selected).map(tag => tag.textContent);
        }

        // Save Data
        function saveData() {
            const data = collectFormData();
            localStorage.setItem('aiHackathonPlan', JSON.stringify(data));
            localStorage.setItem('aiHackathonPlanDate', new Date().toISOString());
            showToast('Saved successfully.', 'success');
        }

        // Load Data
        function loadData() {
            const saved = localStorage.getItem('aiHackathonPlan');
            if (saved) {
                showModal('Load Saved Data', 'Would you like to load the previously saved proposal data?');
            } else {
                showToast('No saved data found.');
            }
        }

        function confirmLoad() {
            const saved = localStorage.getItem('aiHackathonPlan');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    populateFormData(data);
                    showToast('Data loaded successfully.', 'success');
                } catch (e) {
                    console.error('Data Load Error:', e);
                    showToast('Data is corrupted and cannot be loaded.', 'default');
                }
            }
            closeModal();
        }

        // Check for saved data on load
        function checkSavedData() {
            const saved = localStorage.getItem('aiHackathonPlan');
            const savedDate = localStorage.getItem('aiHackathonPlanDate');
            if (saved && savedDate) {
                const date = new Date(savedDate);
                const dateStr = date.toLocaleDateString('en-US') + ' ' + date.toLocaleTimeString('en-US');
                showModal('Saved Data Found', `A proposal saved on ${dateStr} exists. Would you like to load it?`);
            }
        }

        // Auto-save setup
        function setupAutoSave() {
            let timeout;
            document.querySelectorAll('input, textarea, select').forEach(element => {
                element.addEventListener('input', () => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => {
                        const data = collectFormData();
                        localStorage.setItem('aiHackathonPlan', JSON.stringify(data));
                        localStorage.setItem('aiHackathonPlanDate', new Date().toISOString());
                    }, 3000);
                });
            });
        }

        // Effect Section Toggle
        function toggleEffectSection(type) {
            const checkbox = document.getElementById(`effect_${type}_enabled`);
            const content = document.getElementById(`effect_${type}_content`);
            if (checkbox && content) {
                if (checkbox.checked) {
                    content.classList.remove('hidden');
                } else {
                    content.classList.add('hidden');
                }
            }
        }

        // Collect form data
        function collectFormData() {
            // Helper to safely get value
            const getVal = (id) => {
                const el = document.getElementById(id);
                return el ? el.value : '';
            };

            return {
                // Step 1
                projectName: getVal('projectName'),
                coreProject: getVal('coreProject'),
                department: getVal('department'),
                champion: getVal('champion'),
                projectDefinition: getVal('projectDefinition'),
                painPoint: getVal('painPoint'),
                expectedEffect: getVal('expectedEffect'),
                
                // Step 2
                asisDescription: getVal('asisDescription'),
                asisTimeProblem: getVal('asisTimeProblem'),
                asisQualityProblem: getVal('asisQualityProblem'),
                asisSystemProblem: getVal('asisSystemProblem'),
                asisOtherProblem: getVal('asisOtherProblem'),
                systems: getSelectedTags('systemTags'),
                customSystems: getVal('customSystems'),
                
                // Step 3
                tobeDescription: getVal('tobeDescription'),
                aiRole: getVal('aiRole'),
                humanRole: getVal('humanRole'),
                aiInput: getVal('aiInput'),
                aiOutput: getVal('aiOutput'),
                exceptionHandling: getVal('exceptionHandling'),
                
                // Step 4
                requiredData: getVal('requiredData'),
                dataSource: getVal('dataSource'),
                dataFormat: getVal('dataFormat'),
                dataQualityIssue: getVal('dataQualityIssue'),
                dataPreprocessing: getVal('dataPreprocessing'),
                dataUpdateCycle: getVal('dataUpdateCycle'),
                dataSecurity: getVal('dataSecurity'),
                techTags: getSelectedTags('techTags'),
                techDescription: getVal('techDescription'),
                
                // Step 5
                keyBenefit: getVal('keyBenefit'),
                projectDuration: getVal('projectDuration'),
                
                // Quantitative effects
                effect_time_enabled: document.getElementById('effect_time_enabled')?.checked || false,
                effect_time_value: getVal('effect_time_value'),
                effect_time_basis: getVal('effect_time_basis'),
                
                effect_cost_enabled: document.getElementById('effect_cost_enabled')?.checked || false,
                effect_cost_value: getVal('effect_cost_value'),
                effect_cost_basis: getVal('effect_cost_basis'),
                
                effect_revenue_enabled: document.getElementById('effect_revenue_enabled')?.checked || false,
                effect_revenue_value: getVal('effect_revenue_value'),
                effect_revenue_basis: getVal('effect_revenue_basis'),
                
                effect_quality_enabled: document.getElementById('effect_quality_enabled')?.checked || false,
                effect_quality_value: getVal('effect_quality_value'),
                effect_quality_basis: getVal('effect_quality_basis'),
                
                // Qualitative effects
                qualitativeValue: getVal('qualitativeValue'),
                scalability: getVal('scalability'),
                
                // Step 6 Tasks
                task1: { desc: getVal('task1_desc'), prereq: getVal('task1_prereq'), duration: getVal('task1_duration') },
                task2: { desc: getVal('task2_desc'), prereq: getVal('task2_prereq'), duration: getVal('task2_duration') },
                task3: { desc: getVal('task3_desc'), prereq: getVal('task3_prereq'), duration: getVal('task3_duration') },
                task4: { desc: getVal('task4_desc'), prereq: getVal('task4_prereq'), duration: getVal('task4_duration') },
                task5: { desc: getVal('task5_desc'), prereq: getVal('task5_prereq'), duration: getVal('task5_duration') }
            };
        }

        // Populate form with saved data
        function populateFormData(data) {
            if (!data) return;

            const setVal = (id, val) => {
                const el = document.getElementById(id);
                if (el && val !== undefined) el.value = val;
            };

            // Step 1
            setVal('projectName', data.projectName);
            setVal('coreProject', data.coreProject);
            setVal('department', data.department);
            setVal('champion', data.champion);
            setVal('projectDefinition', data.projectDefinition);
            setVal('painPoint', data.painPoint);
            setVal('expectedEffect', data.expectedEffect);
            
            // Step 2
            setVal('asisDescription', data.asisDescription);
            setVal('asisTimeProblem', data.asisTimeProblem);
            setVal('asisQualityProblem', data.asisQualityProblem);
            setVal('asisSystemProblem', data.asisSystemProblem);
            setVal('asisOtherProblem', data.asisOtherProblem);
            setVal('customSystems', data.customSystems);
            
            // Restore system tags
            if (data.systems && Array.isArray(data.systems)) {
                document.querySelectorAll('#systemTags .tech-tag').forEach(tag => {
                    // Reset first
                    tag.classList.remove('selected');
                    if (data.systems.includes(tag.textContent)) {
                        tag.classList.add('selected');
                    }
                });
            }
            
            // Step 3
            setVal('tobeDescription', data.tobeDescription);
            setVal('aiRole', data.aiRole);
            setVal('humanRole', data.humanRole);
            setVal('aiInput', data.aiInput);
            setVal('aiOutput', data.aiOutput);
            setVal('exceptionHandling', data.exceptionHandling);
            
            // Step 4
            setVal('requiredData', data.requiredData);
            setVal('dataSource', data.dataSource);
            setVal('dataFormat', data.dataFormat);
            setVal('dataQualityIssue', data.dataQualityIssue);
            setVal('dataPreprocessing', data.dataPreprocessing);
            setVal('dataUpdateCycle', data.dataUpdateCycle);
            setVal('dataSecurity', data.dataSecurity);
            setVal('techDescription', data.techDescription);
            
            // Restore tech tags
            if (data.techTags && Array.isArray(data.techTags)) {
                document.querySelectorAll('#techTags .tech-tag').forEach(tag => {
                    tag.classList.remove('selected');
                    if (data.techTags.includes(tag.textContent)) {
                        tag.classList.add('selected');
                    }
                });
            }
            
            // Step 5
            setVal('keyBenefit', data.keyBenefit);
            setVal('projectDuration', data.projectDuration);
            
            // Helper for effects
            const setEffect = (type, enabled, val, basis) => {
                const chk = document.getElementById(`effect_${type}_enabled`);
                if (chk) {
                    chk.checked = !!enabled;
                    toggleEffectSection(type);
                }
                setVal(`effect_${type}_value`, val);
                setVal(`effect_${type}_basis`, basis);
            };

            setEffect('time', data.effect_time_enabled, data.effect_time_value, data.effect_time_basis);
            setEffect('cost', data.effect_cost_enabled, data.effect_cost_value, data.effect_cost_basis);
            setEffect('revenue', data.effect_revenue_enabled, data.effect_revenue_value, data.effect_revenue_basis);
            setEffect('quality', data.effect_quality_enabled, data.effect_quality_value, data.effect_quality_basis);
            
            // Qualitative effects
            setVal('qualitativeValue', data.qualitativeValue);
            setVal('scalability', data.scalability);
            
            // Tasks (Use Optional Chaining for safe access)
            setVal('task1_desc', data.task1?.desc);
            setVal('task1_prereq', data.task1?.prereq);
            setVal('task1_duration', data.task1?.duration);

            setVal('task2_desc', data.task2?.desc);
            setVal('task2_prereq', data.task2?.prereq);
            setVal('task2_duration', data.task2?.duration);

            setVal('task3_desc', data.task3?.desc);
            setVal('task3_prereq', data.task3?.prereq);
            setVal('task3_duration', data.task3?.duration);

            setVal('task4_desc', data.task4?.desc);
            setVal('task4_prereq', data.task4?.prereq);
            setVal('task4_duration', data.task4?.duration);

            setVal('task5_desc', data.task5?.desc);
            setVal('task5_prereq', data.task5?.prereq);
            setVal('task5_duration', data.task5?.duration);
        }

        // Validation
        function setupValidation() {
            const step1Fields = ['painPoint', 'projectDefinition', 'expectedEffect'];
            step1Fields.forEach(field => {
                const el = document.getElementById(field);
                if(el) el.addEventListener('input', validateStep1);
            });
        }

        function validateStep1() {
            const painPoint = document.getElementById('painPoint').value;
            const definition = document.getElementById('projectDefinition').value;
            const effect = document.getElementById('expectedEffect').value;
            
            const updateUI = (id, condition) => {
                const item = document.getElementById(id);
                if (!item) return;
                
                if (condition) {
                    item.classList.add('pass');
                    item.classList.remove('fail');
                    item.querySelector('.validation-icon').textContent = '‚úì';
                } else if (painPoint.length > 0 || definition.length > 0 || effect.length > 0) {
                    item.classList.add('fail');
                    item.classList.remove('pass');
                    item.querySelector('.validation-icon').textContent = '!';
                }
            };

            updateUI('v1-painpoint', painPoint.length > 50 && (painPoint.includes('time') || painPoint.includes('cost') || painPoint.includes('depend')));
            updateUI('v1-how', definition.length > 30 && !definition.includes('figure it out') && (definition.includes('through') || definition.includes('analysis') || definition.includes('recommend')));
            updateUI('v1-connection', effect.length > 30 && (effect.includes('AI') || effect.includes('auto') || effect.includes('analysis')));
        }

        function runFinalValidation() {
            const data = collectFormData();
            
            // Helper
            const check = (id, condition) => updateValidation(id, condition);

            check('vf-tobe', (data.tobeDescription || '').length > 100);
            
            const hasQuantitativeEffect = 
                (data.effect_time_enabled && data.effect_time_value.length > 20) ||
                (data.effect_cost_enabled && data.effect_cost_value.length > 20) ||
                (data.effect_revenue_enabled && data.effect_revenue_value.length > 20) ||
                (data.effect_quality_enabled && data.effect_quality_value.length > 20);
            check('vf-roi', hasQuantitativeEffect);
            
            check('vf-scalability', (data.scalability || '').length > 30);
            check('vf-aicollab', (data.aiRole || '').length > 30 && (data.humanRole || '').length > 30);
            check('vf-datasample', (data.requiredData || '').length > 30 && (data.dataSource || '').length > 20);
            check('vf-dataprocess', (data.dataPreprocessing || '').length > 20);
            check('vf-compliance', (data.dataSecurity || '').length > 10);
            check('vf-interaction', (data.aiInput || '').length > 20 && (data.aiOutput || '').length > 20);
            check('vf-validation', (data.humanRole || '').includes('review') || (data.humanRole || '').includes('verify') || (data.humanRole || '').includes('check'));
            check('vf-exception', (data.exceptionHandling || '').length > 20);
        }

        function updateValidation(id, pass) {
            const item = document.getElementById(id);
            if (!item) return;
            if (pass) {
                item.classList.add('pass');
                item.classList.remove('fail');
                item.querySelector('.validation-icon').textContent = '‚úì';
            } else {
                item.classList.add('fail');
                item.classList.remove('pass');
                item.querySelector('.validation-icon').textContent = '!';
            }
        }

        // Generate Preview - Real-time data reflection (XSS prevention applied)
        function generatePreview() {
            const data = collectFormData();
            const container = document.getElementById('previewContainer');
            
            // Generate quantitative effects HTML
            let quantitativeEffectsHTML = '';
            
            if (data.effect_time_enabled && data.effect_time_value) {
                quantitativeEffectsHTML += `
                    <div style="margin-bottom: 16px; padding: 12px; background: #f8fafc; border-radius: 8px;">
                        <strong>‚è±Ô∏è Time Savings</strong>
                        <p style="margin: 8px 0;">${formatText(data.effect_time_value)}</p>
                        ${data.effect_time_basis ? `<p style="font-size: 13px; color: #64748b;"><em>Calculation Basis:</em> ${formatText(data.effect_time_basis)}</p>` : ''}
                    </div>
                `;
            }
            
            if (data.effect_cost_enabled && data.effect_cost_value) {
                quantitativeEffectsHTML += `
                    <div style="margin-bottom: 16px; padding: 12px; background: #f8fafc; border-radius: 8px;">
                        <strong>üí∞ Cost Reduction</strong>
                        <p style="margin: 8px 0;">${formatText(data.effect_cost_value)}</p>
                        ${data.effect_cost_basis ? `<p style="font-size: 13px; color: #64748b;"><em>Calculation Basis:</em> ${formatText(data.effect_cost_basis)}</p>` : ''}
                    </div>
                `;
            }
            
            if (data.effect_revenue_enabled && data.effect_revenue_value) {
                quantitativeEffectsHTML += `
                    <div style="margin-bottom: 16px; padding: 12px; background: #f8fafc; border-radius: 8px;">
                        <strong>üìà Revenue/Profit Increase</strong>
                        <p style="margin: 8px 0;">${formatText(data.effect_revenue_value)}</p>
                        ${data.effect_revenue_basis ? `<p style="font-size: 13px; color: #64748b;"><em>Calculation Basis:</em> ${formatText(data.effect_revenue_basis)}</p>` : ''}
                    </div>
                `;
            }
            
            if (data.effect_quality_enabled && data.effect_quality_value) {
                quantitativeEffectsHTML += `
                    <div style="margin-bottom: 16px; padding: 12px; background: #f8fafc; border-radius: 8px;">
                        <strong>‚úÖ Quality/Accuracy Improvement</strong>
                        <p style="margin: 8px 0;">${formatText(data.effect_quality_value)}</p>
                        ${data.effect_quality_basis ? `<p style="font-size: 13px; color: #64748b;"><em>Calculation Basis:</em> ${formatText(data.effect_quality_basis)}</p>` : ''}
                    </div>
                `;
            }

            // Generate task table HTML
            let taskTableHTML = '';
            const tasks = [data.task1, data.task2, data.task3, data.task4, data.task5];
            const validTasks = tasks.filter(t => t && t.desc);
            if (validTasks.length > 0) {
                taskTableHTML = `
                    <table class="preview-table">
                        <tr><th style="width: 10%;">No.</th><th>Task</th><th style="width: 15%;">Prerequisites</th><th style="width: 15%;">Duration</th></tr>
                        ${validTasks.map((t, i) => `<tr><td>${i+1}</td><td>${escapeHtml(t.desc)}</td><td>${escapeHtml(t.prereq) || '-'}</td><td>${escapeHtml(t.duration) || '-'}</td></tr>`).join('')}
                    </table>
                `;
            }
            
            // Combine system tags
            const systemList = [...(data.systems || []), data.customSystems].filter(Boolean).join(', ');

            container.innerHTML = `
                <div class="preview-header">
                    <h1>Planning Hackathon Proposal</h1>
                    <h2>${escapeHtml(data.projectName) || '[Proposal Name]'}</h2>
                </div>
                
                <div class="preview-section">
                    <h3>1. Overview</h3>
                    <table class="preview-table">
                        <tr><th>Proposal Name</th><td>${escapeHtml(data.projectName) || '-'}</td></tr>
                        <tr><th>Core Objective</th><td>${escapeHtml(data.coreProject) || '-'}</td></tr>
                        <tr><th>Department</th><td>${escapeHtml(data.department) || '-'}</td></tr>
                        <tr><th>AI Champion</th><td>${escapeHtml(data.champion) || '-'}</td></tr>
                        <tr><th>Project Definition</th><td>${escapeHtml(data.projectDefinition) || '-'}</td></tr>
                        <tr><th>Problem to Solve</th><td>${formatText(data.painPoint)}</td></tr>
                        <tr><th>Expected Benefits</th><td>${formatText(data.expectedEffect)}</td></tr>
                        <tr><th>Project Duration</th><td>${escapeHtml(data.projectDuration) || '-'} months</td></tr>
                    </table>
                </div>
                
                <div class="preview-section">
                    <h3>2. As-Is Current State</h3>
                    <div class="preview-content">
                        <p><strong>Current Business Process:</strong></p>
                        <p>${formatText(data.asisDescription)}</p>
                        <br>
                        <p><strong>Issues:</strong></p>
                        <ul style="margin-left: 20px;">
                            ${data.asisTimeProblem ? `<li>Time Inefficiency: ${escapeHtml(data.asisTimeProblem)}</li>` : ''}
                            ${data.asisQualityProblem ? `<li>Quality/Accuracy Issues: ${escapeHtml(data.asisQualityProblem)}</li>` : ''}
                            ${data.asisSystemProblem ? `<li>System/Data Issues: ${escapeHtml(data.asisSystemProblem)}</li>` : ''}
                            ${data.asisOtherProblem ? `<li>Other: ${escapeHtml(data.asisOtherProblem)}</li>` : ''}
                        </ul>
                        <br>
                        <p><strong>Systems Used:</strong> ${escapeHtml(systemList) || '-'}</p>
                    </div>
                </div>
                
                <div class="preview-section">
                    <h3>3. To-Be Scenario (After AI Adoption)</h3>
                    <div class="preview-content">
                        <p><strong>Changed Business Process:</strong></p>
                        <p>${formatText(data.tobeDescription)}</p>
                        <br>
                        <p><strong>AI Role:</strong></p>
                        <p>${formatText(data.aiRole)}</p>
                        <br>
                        <p><strong>Human Role:</strong></p>
                        <p>${formatText(data.humanRole)}</p>
                        <br>
                        <p><strong>AI Input/Output:</strong></p>
                        <p>‚Ä¢ Input: ${escapeHtml(data.aiInput) || '-'}</p>
                        <p>‚Ä¢ Output: ${escapeHtml(data.aiOutput) || '-'}</p>
                        <br>
                        <p><strong>Exception Handling:</strong></p>
                        <p>${formatText(data.exceptionHandling)}</p>
                    </div>
                </div>
                
                <div class="preview-section">
                    <h3>4. Data & Technology</h3>
                    <div class="preview-content">
                        <p><strong>Required Data:</strong></p>
                        <p>${formatText(data.requiredData)}</p>
                        <br>
                        <p><strong>Data Source:</strong> ${formatText(data.dataSource)}</p>
                        <p><strong>Data Format:</strong> ${formatText(data.dataFormat)}</p>
                        <p><strong>Update Cycle:</strong> ${escapeHtml(data.dataUpdateCycle) || '-'}</p>
                        <br>
                        <p><strong>Preprocessing Plan:</strong></p>
                        <p>${formatText(data.dataPreprocessing)}</p>
                        <br>
                        <p><strong>Security Considerations:</strong></p>
                        <p>${formatText(data.dataSecurity)}</p>
                        <br>
                        <p><strong>Related Technologies:</strong> ${escapeHtml(data.techTags.join(', ')) || '-'}</p>
                        <p>${escapeHtml(data.techDescription) || ''}</p>
                    </div>
                </div>
                
                <div class="preview-section">
                    <h3>5. Expected Benefits & ROI</h3>
                    <div class="preview-content">
                        ${data.keyBenefit ? `
                            <div style="background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%); color: white; padding: 16px 20px; border-radius: 8px; margin-bottom: 20px;">
                                <strong>üéØ Key Expected Benefit:</strong> ${escapeHtml(data.keyBenefit)}
                            </div>
                        ` : ''}
                        
                        <p><strong>üìä Quantitative Benefits</strong></p>
                        ${quantitativeEffectsHTML || '<p style="color: #94a3b8;">No quantitative benefits registered.</p>'}
                        
                        <br>
                        <p><strong>‚ú® Qualitative Benefits</strong></p>
                        <p>${formatText(data.qualitativeValue)}</p>
                        
                        <br>
                        <p><strong>üöÄ Scalability</strong></p>
                        <p>${formatText(data.scalability)}</p>
                    </div>
                </div>
                
                <div class="preview-section">
                    <h3>6. Execution Tasks</h3>
                    <div class="preview-content">
                        ${taskTableHTML || '<p>No tasks registered.</p>'}
                    </div>
                </div>
            `;
        }

        // Export to PDF
        function exportToPDF() {
            const data = collectFormData();
            const element = document.getElementById('previewContainer');
            
            // Update preview first
            generatePreview();
            
            const opt = {
                margin: [10, 10, 10, 10],
                filename: `AI_Hackathon_Proposal_${data.projectName || 'Untitled'}_${new Date().toISOString().split('T')[0]}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2, 
                    useCORS: true,
                    letterRendering: true
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait' 
                },
                pagebreak: { mode: 'avoid-all', before: '.preview-section' }
            };
            
            showToast('Generating PDF...', 'default');
            
            html2pdf().set(opt).from(element).save().then(() => {
                showToast('PDF saved successfully.', 'success');
            }).catch(err => {
                console.error('PDF generation error:', err);
                showToast('Error occurred while generating PDF.', 'default');
            });
        }

        // Export to Word (HTML based)
        function exportToWord() {
            const data = collectFormData();
            
            // Update preview first
            generatePreview();
            
            const previewContent = document.getElementById('previewContainer').innerHTML;
            
            const htmlContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: 'Arial', 'Helvetica', sans-serif; line-height: 1.6; padding: 20px; }
                        h1 { text-align: center; color: #1a56db; border-bottom: 2px solid #1a56db; padding-bottom: 10px; }
                        h2 { text-align: center; color: #1e40af; }
                        h3 { background: #f1f5f9; padding: 10px 16px; border-left: 4px solid #1a56db; margin-top: 24px; }
                        table { width: 100%; border-collapse: collapse; margin: 16px 0; }
                        th, td { border: 1px solid #e2e8f0; padding: 10px; text-align: left; }
                        th { background: #f1f5f9; font-weight: bold; width: 150px; }
                        p { margin: 8px 0; }
                        ul { margin-left: 20px; }
                        strong { color: #0f172a; }
                    </style>
                </head>
                <body>
                    ${previewContent}
                </body>
                </html>
            `;
            
            const blob = new Blob(['\ufeff' + htmlContent], { type: 'application/msword;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `AI_Hackathon_Proposal_${data.projectName || 'Untitled'}_${new Date().toISOString().split('T')[0]}.doc`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showToast('Word document saved successfully.', 'success');
        }

        // Submit
        function submitPlan() {
            saveData();
            showToast('üéâ Proposal saved! Please submit by end of March.', 'success');
        }

        // Modal
        function showModal(title, message) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('modalOverlay').classList.add('show');
        }

        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('show');
        }

        // Toast
        function showToast(message, type = 'default') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            const toastIcon = document.getElementById('toastIcon');
            
            toastMessage.textContent = message;
            toastIcon.textContent = type === 'success' ? '‚úì' : '‚Ñπ';
            
            toast.classList.remove('success');
            if (type === 'success') {
                toast.classList.add('success');
            }
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Close modal on overlay click
        document.getElementById('modalOverlay').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>
